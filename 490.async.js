"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[490],{48268:function(e,t,n){n.d(t,{y:function(){return c}});var r=n(97857),a=n.n(r),s=n(62435),i=n(61895),o=n(86074),u=function(e){var t=e.defaultValue,n=void 0===t?"-":t,r=e.value,a=e.defaultValueIncludeSuffix,u=void 0!==a&&a,c=e.displayDecimals,l=e.label,p=void 0===l?"":l,d=e.thousandSeparator,y=void 0===d||d,f=e.prefix,m=void 0===f?"":f,b=e.suffix,h=void 0===b?"":b,v=(0,s.useMemo)((function(){return null==r?u?"".concat(m||"").concat(n).concat(h||""):n:(0,i.dp)(r).display({thousandSeparator:y,prefix:m,suffix:h})}),[r,n,c,y,m,h]);return(0,o.jsxs)(o.Fragment,{children:[p,v]})},c=function(e){var t=e.separator,n=void 0===t?"/":t,r=e.values;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u,a()({},r[0]||{})),n,(0,o.jsx)(u,a()({},r[1]||{}))]})};t.Z=u},61895:function(e,t,n){n.d(t,{Q6:function(){return o},dp:function(){return u}});var r=n(2593),a=n(70794),s=n(24069),i=n(36493);function o(e){return e instanceof r.O$?(0,a.Z)((0,s.dN)(e,18,2)):(0,a.Z)("..."===e?0:e)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-";if(null==e||isNaN(Number(e)))return{display:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null==e?void 0:e.defaultDisplay)||"-"},number:o(0),value:n};var r=o(e),a=r.toFixed(t,1);return(0,i.R$)().showFullDecimals&&(a=r.toString()),{display:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.thousandSeparator,n=void 0===t||t,r=e.prefix,s=void 0===r?"$":r,i=e.suffix,o=void 0===i?"":i,u=n?c(a):a;return"".concat(s||"").concat(u).concat(o||"")},number:r,value:a}}function c(e){return e?e.replace(/\d+/,(function(e){return e.replace(/(\d)(?=(\d{3})+$)/g,(function(e){return e+","}))})):""}},92499:function(e,t,n){n.d(t,{Z:function(){return L}});var r=n(9783),a=n.n(r),s=n(97857),i=n.n(s),o=n(5574),u=n.n(o),c=n(34713),l=n(62435),p=n(60088),d=n(4480),y=n(95591),f=n(15009),m=n.n(f),b=n(99289),h=n.n(b),v=n(12444),k=n.n(v),g=n(72004),T=n.n(g),x=n(31996),w=n.n(x),S=n(26037),M=n.n(S),C=JSON.parse('{"Mt":[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"market","type":"address"},{"indexed":false,"internalType":"address","name":"marketValid","type":"address"},{"indexed":false,"internalType":"address","name":"orderBookLong","type":"address"},{"indexed":false,"internalType":"address","name":"orderBookShort","type":"address"}],"name":"Create","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"role","type":"bytes32"},{"indexed":true,"internalType":"bytes32","name":"previousAdminRole","type":"bytes32"},{"indexed":true,"internalType":"bytes32","name":"newAdminRole","type":"bytes32"}],"name":"RoleAdminChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"role","type":"bytes32"},{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":true,"internalType":"address","name":"sender","type":"address"}],"name":"RoleGranted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"role","type":"bytes32"},{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":true,"internalType":"address","name":"sender","type":"address"}],"name":"RoleRevoked","type":"event"},{"inputs":[],"name":"DEFAULT_ADMIN_ROLE","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"allMarketsLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"string","name":"_name","type":"string"},{"internalType":"address","name":"_marketAddress","type":"address"},{"internalType":"address","name":"_marketValid","type":"address"},{"internalType":"address","name":"_marketRouter","type":"address"},{"internalType":"address","name":"_orderBookLong","type":"address"},{"internalType":"address","name":"_orderBookShort","type":"address"},{"internalType":"address","name":"_indexToken","type":"address"},{"internalType":"address","name":"_feeRouter","type":"address"},{"internalType":"address","name":"_feeVault","type":"address"},{"internalType":"address","name":"_positionBook","type":"address"},{"internalType":"address","name":"_openStoreLong","type":"address"},{"internalType":"address","name":"_closeStoreLong","type":"address"},{"internalType":"address","name":"_openStoreShort","type":"address"},{"internalType":"address","name":"_closeStoreShort","type":"address"},{"internalType":"address","name":"_addressProvider","type":"address"},{"internalType":"uint256","name":"_minSlippage","type":"uint256"},{"internalType":"uint256","name":"_maxSlippage","type":"uint256"},{"internalType":"uint256","name":"_minLeverage","type":"uint256"},{"internalType":"uint256","name":"_maxLeverage","type":"uint256"},{"internalType":"uint256","name":"_maxTradeAmount","type":"uint256"},{"internalType":"uint256","name":"_minPay","type":"uint256"},{"internalType":"uint256","name":"_minCollateral","type":"uint256"},{"internalType":"bool","name":"_allowOpen","type":"bool"},{"internalType":"bool","name":"_allowClose","type":"bool"},{"internalType":"uint256","name":"_tokenDigits","type":"uint256"},{"internalType":"address","name":"_vault","type":"address"},{"internalType":"address","name":"_vaultRouter","type":"address"},{"internalType":"address","name":"_collateralToken","type":"address"}],"internalType":"struct MarketFactory.CreateInputs","name":"_inputs","type":"tuple"}],"name":"create","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_marketAddr","type":"address"}],"name":"getMarket","outputs":[{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"address","name":"addr","type":"address"}],"internalType":"struct IMarketFactory.Props","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMarkets","outputs":[{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"address","name":"addr","type":"address"}],"internalType":"struct IMarketFactory.Props[]","name":"_markets","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getMarketsV2","outputs":[{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"address","name":"addr","type":"address"},{"internalType":"bool","name":"allowOpen","type":"bool"},{"internalType":"bool","name":"allowClose","type":"bool"}],"internalType":"struct IMarketFactory.Outs[]","name":"_outs","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"}],"name":"getRoleAdmin","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"grantRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"hasRole","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"markets","outputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"address","name":"addr","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"renounceRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"role","type":"bytes32"},{"internalType":"address","name":"account","type":"address"}],"name":"revokeRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_marketAddr","type":"address"},{"internalType":"address","name":"_newMarketAddr","type":"address"}],"name":"update","outputs":[],"stateMutability":"nonpayable","type":"function"}]}'),_=function(e){w()(r,e);var t,n=M()(r);function r(e,t,a){return k()(this,r),n.call(this,e,t,C.Mt,a)}return T()(r,[{key:"getMarkets",value:(t=h()(m()().mark((function e(){var t;return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call("getMarkets");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getClassName",value:function(){return"MarketFactory"}}]),r}(n(76935).k),R=n(27960),A={name:"BTC/USDT",address:"0xbEcC4Cd3bC7E912bCeA6EFE3F8379a7018455F99"},I=function(){var e=h()(m()().mark((function e(t,n){var r,a,s;return m()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,R.K)(t,"MarketFactory"),a=new _(n,t,r),e.next=4,a.getMarkets();case 4:if(e.t0=e.sent.map((function(e){return i()(i()({},e),{},{address:e.addr})})),e.t0){e.next=7;break}e.t0=[];case 7:return 0==(s=e.t0).length&&(console.warn("failed to get markets"),s.push(A)),e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),P=n(37432),B=n(36493),F=n(4872),O=n(45066),L=function(){var e=(0,P.x)().chainId,t=(0,c.Ge)().library,n=(0,y.ZP)("".concat(e),(function(){return I(e,t)})).data,r=(0,d.FV)(F.O7),s=u()(r,2)[1],o=(0,d.FV)(F.tr),f=u()(o,2)[1],m=(0,d.FV)(F.bI),b=u()(m,2),h=b[0],v=b[1],k=n&&(null==n?void 0:n.length)>0?"subscribeTickerBatch":null;(0,p.Z)(k,(function(){var e=n.map((function(e){return(0,B.do)(null==e?void 0:e.name).toLowerCase()}));return(0,O.C)(e,(function(e){s((function(t){return i()(i()({},t),{},a()({},e.symbol,e))}))}))})),(0,l.useEffect)((function(){return f(n)}),[n]),(0,l.useEffect)((function(){n&&n.length&&(h||v(n[0]))}),[n,h])}},28722:function(e,t,n){n.d(t,{Dw:function(){return h},Jx:function(){return f},eI:function(){return y},x7:function(){return b}});var r,a=n(15009),s=n.n(a),i=n(99289),o=n.n(i),u=n(9783),c=n.n(u),l=n(88610),p=n(46495),d=n(13805);function y(e){return new l.f({uri:e,cache:new p.h})}var f="https://api.thegraph.com/subgraphs/name/dalveytechaaron/fuji",m=(r={},c()(r,d.Qz,f),c()(r,d.bx,f),r),b=function(e){return m[e]||f},h=function(){var e=o()(s()().mark((function e(t,n){var r,a;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST",body:JSON.stringify({query:n}),mode:"cors"}).catch((function(e){console.log("err",e)}));case 2:return r=e.sent,e.next=5,null==r?void 0:r.json();case 5:return a=e.sent,e.abrupt("return",(null==a?void 0:a.data)||{});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},96714:function(e,t,n){n.d(t,{P:function(){return a},m:function(){return r}});var r=function(e){if(!e)return"";var t,n=new Date(1e3*e);if(!((t=n)instanceof Date)||isNaN(+t))return"";var r=(null==n?void 0:n.getMonth())+1;return(r=(null==n?void 0:n.getMonth())>9?""+r:"0"+r)+"/"+((null==n?void 0:n.getDate())>9?null==n?void 0:n.getDate():"0"+(null==n?void 0:n.getDate()))+" "+((null==n?void 0:n.getHours())>9?null==n?void 0:n.getHours():"0"+(null==n?void 0:n.getHours()))+":"+((null==n?void 0:n.getMinutes())>9?null==n?void 0:n.getMinutes():"0"+(null==n?void 0:n.getMinutes()))},a="-"},43050:function(e,t,n){n.d(t,{Z:function(){return g}});var r,a=n(15009),s=n.n(a),i=n(99289),o=n.n(i),u=n(8433),c=n(97857),l=n.n(c),p=n(12444),d=n.n(p),y=n(72004),f=n.n(y);!function(e){e.ConnectFailed="ConnectFailed",e.NoSupportCountry="NoSupportCountry"}(r||(r={}));var m,b=function(){function e(t){d()(this,e),this.url=t,this.socket=null,this.isOpened=!1,this.messageQueue=[],this.reconnectTimer=null,this.pingTimer=null,this.idCounter=1,this.reconnectCount=0,this.subscriptions=new Map,this.usingRestfulAPI=!1,this.initWebSocket()}var t;return f()(e,[{key:"initWebSocket",value:function(){var e=this;this.socket=new WebSocket(this.url),this.socket.onopen=function(){e.isOpened=!0,e.usingRestfulAPI=!1,e.sendCachedMessages(),e.heartBeat(),e.stopReconnect()},this.socket.onmessage=function(t){return e.onMessage(t)},this.socket.onclose=function(){e.isOpened=!1,e.stopHeartBeat(),e.reconnect()},this.socket.onerror=function(t){console.error("WebSocket error: ",t),e.isOpened=!1,e.stopHeartBeat()}}},{key:"send",value:function(e){this.isOpened?this.socket.send(JSON.stringify(e)):this.messageQueue.push(e)}},{key:"reconnect",value:function(){console.log("websocket reconnecting..."),clearInterval(this.reconnectTimer);var e=this;this.isOpened=!1,this.reconnectTimer=setTimeout((function(){if(e.reconnectCount>=2)return console.error("WebSocket connection failed after multiple attempts."),e.stopReconnect(),e.usingRestfulAPI=!0,void e.pollRestfulAPI();e.reconnectCount++,e.initWebSocket()}),2e3)}},{key:"subscribe",value:function(e,t,n,r){var a=this.idCounter++,s=l()(l()({},e),{},{id:a});return this.subscriptions.set(a,{callback:t,predicate:n,restfulApiFunc:r}),this.usingRestfulAPI?this.pollRestfulAPI(a):this.send(s),a}},{key:"onMessage",value:function(e){var t=JSON.parse(e.data);try{this.subscriptions.forEach((function(e){var n=e.callback,r=e.predicate;void 0!==(null==t?void 0:t.error)?n(t.error,null):r(t)&&n(null,t)}))}catch(e){console.log("onMessage error: ",e)}}},{key:"pollRestfulAPI",value:function(e){var t=this;e?this.pollRestfulAPIForSubscription(e):this.subscriptions.forEach((function(e,n){t.pollRestfulAPIForSubscription(n)}))}},{key:"pollRestfulAPIForSubscription",value:(t=o()(s()().mark((function e(t){var n,r,a,i,o;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.subscriptions.get(t),r=n.restfulApiFunc,a=n.callback,i=n.predicate,r){e.next=4;break}return e.abrupt("return");case 4:n.hasOwnProperty("shouldStop")||(n.shouldStop=!1);case 5:if(!this.usingRestfulAPI||n.shouldStop){e.next=20;break}return e.prev=6,e.next=9,r();case 9:o=e.sent,i(o)&&a(null,o),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),a(e.t0,null);case 16:return e.next=18,new Promise((function(e){return setTimeout(e,1e3)}));case 18:e.next=5;break;case 20:case"end":return e.stop()}}),e,this,[[6,13]])}))),function(e){return t.apply(this,arguments)})},{key:"stopPollingById",value:function(e){var t=this.subscriptions.get(e);t&&(t.shouldStop=!0)}},{key:"stopReconnect",value:function(){clearTimeout(this.reconnectTimer),this.reconnectTimer=null,this.reconnectCount=0}},{key:"heartBeat",value:function(){}},{key:"stopHeartBeat",value:function(){clearInterval(this.pingTimer),this.pingTimer=null}},{key:"unsubscribe",value:function(e){this.stopPollingById(e),this.subscriptions.delete(e),console.log("unsubscribe: ",this.subscriptions.get(e))}},{key:"sendCachedMessages",value:function(){for(;this.messageQueue.length>0;)this.send(this.messageQueue.shift())}},{key:"close",value:function(){this.socket.close(),this.stopHeartBeat()}}]),e}(),h=new b("wss://fstream.binance.com/stream"),v=u.Z.create({baseURL:"https://fapi.binance.com/fapi/v1/",timeout:5e3}),k={getKLines:function(e,t){return v.get("klines",{params:{symbol:e,interval:t}})},subscribeKLine:function(e,t){var n=e.symbol,r=e.period,a="".concat(n,"@kline_").concat(r),s=h.subscribe({method:"SUBSCRIBE",params:[a]},t,(function(e){return e.stream===a}));return function(){h.subscribe({method:"UNSUBSCRIBE",params:[a]},t,(function(e){return e.stream===a})),h.unsubscribe(s)}},getTickerPrice:function(e){return v.get("ticker/price",{params:{symbol:e}})},get24HChange:(m=o()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v.get("ticker/24hr",{params:{symbol:t}}));case 1:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)}),subscribeTickerBatch:function(e,t,n){var r=h.subscribe({method:"SUBSCRIBE",params:e},t,(function(e){var t;return null==e||null===(t=e.stream)||void 0===t?void 0:t.includes("@ticker")}),n);return function(){h.subscribe({method:"UNSUBSCRIBE",params:e},t,(function(e){var t;return null==e||null===(t=e.stream)||void 0===t?void 0:t.includes("@ticker")})),h.unsubscribe(r)}}},g=k},45066:function(e,t,n){n.d(t,{C:function(){return m},f:function(){return f}});var r=n(96695),a=n.n(r),s=n(15009),i=n.n(s),o=n(5574),u=n.n(o),c=n(99289),l=n.n(c),p=n(43050),d=n(61895),y=function(e){return{symbol:e.s.toLowerCase(),indexPrice:(0,d.Q6)(e.c),"24Height":(0,d.Q6)(e.h),"24Low":(0,d.Q6)(e.l),"24Change":(0,d.Q6)(e.p),"24ChangeRate":(0,d.Q6)(e.P)}};function f(e,t){var n=e.symbol,r=e.period;return p.Z.subscribeKLine({symbol:n,period:r},(function(e,n){var r;e||t({time:(r=n.data).k.t/1e3,open:r.k.o,close:r.k.c,height:r.k.h,low:r.k.l})}))}function m(e,t){var n=function(){var e=l()(i()().mark((function e(t){var n,r,a,s,o;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([p.Z.getTickerPrice(t),p.Z.get24HChange(t)]).catch((function(e){return console.error("Failed to get ticker info for ".concat(t),e),[null,null]}));case 2:if(n=e.sent,r=u()(n,2),a=r[0].data,s=r[1].data,a&&s){e.next=8;break}return e.abrupt("return");case 8:return o=y({s:a.symbol,c:a.price,g:s.highPrice,l:s.lowPrice,p:s.priceChange,P:s.priceChangePercent}),e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return p.Z.subscribeTickerBatch(e.map((function(e){return"".concat(e,"@ticker")})),(function(e,n){e||t(y(n.data))}),l()(i()().mark((function r(){var s,o,u,c;return i()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:s=a()(e),r.prev=1,s.s();case 3:if((o=s.n()).done){r.next=11;break}return u=o.value,r.next=7,n(u);case 7:c=r.sent,t(c);case 9:r.next=3;break;case 11:r.next=16;break;case 13:r.prev=13,r.t0=r.catch(1),s.e(r.t0);case 16:return r.prev=16,s.f(),r.finish(16);case 19:case"end":return r.stop()}}),r,null,[[1,13,16,19]])}))))}},4872:function(e,t,n){n.d(t,{bI:function(){return u},O7:function(){return o},tr:function(){return i}});var r=n(4480),a=n(36493),s=(0,n(6983).J)({key:"depx-user-preference"}).persistAtom,i=(0,r.cn)({key:"marketsAtom",default:[]}),o=(0,r.cn)({key:"marketStoreAtom",default:{}}),u=(0,r.cn)({key:"marketSelectionAtom",default:"",effects_UNSTABLE:[s]});(0,r.nZ)({key:"symbolSelectionAtom",get:function(e){var t=(0,e.get)(u);return(0,a.do)(null==t?void 0:t.name).toLowerCase()}})}}]);